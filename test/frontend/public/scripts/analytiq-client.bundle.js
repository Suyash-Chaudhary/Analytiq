(()=>{var t={493:(t,e,n)=>{var i=n(264);function o(t,e){var n=new i(t,e);return function(t){return n.convert(t)}}o.BIN="01",o.OCT="01234567",o.DEC="0123456789",o.HEX="0123456789abcdef",t.exports=o},264:t=>{"use strict";function e(t,e){if(!(t&&e&&t.length&&e.length))throw new Error("Bad alphabet");this.srcAlphabet=t,this.dstAlphabet=e}e.prototype.convert=function(t){var e,n,i,o={},r=this.srcAlphabet.length,s=this.dstAlphabet.length,a=t.length,c="string"==typeof t?"":[];if(!this.isValid(t))throw new Error('Number "'+t+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return t;for(e=0;e<a;e++)o[e]=this.srcAlphabet.indexOf(t[e]);do{for(n=0,i=0,e=0;e<a;e++)(n=n*r+o[e])>=s?(o[i++]=parseInt(n/s,10),n%=s):i>0&&(o[i++]=0);a=i,c=this.dstAlphabet.slice(n,n+1).concat(c)}while(0!==i);return c},e.prototype.isValid=function(t){for(var e=0;e<t.length;++e)if(-1===this.srcAlphabet.indexOf(t[e]))return!1;return!0},t.exports=e},943:(t,e,n)=>{const{v4:i,validate:o}=n(831),r=n(493),s={cookieBase90:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&'()*+-./:<=>?@[]^_`{|}~",flickrBase58:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",uuid25Base36:"0123456789abcdefghijklmnopqrstuvwxyz"},a={consistentLength:!0};let c;const u=(t,e,n)=>{const i=e(t.toLowerCase().replace(/-/g,""));return n&&n.consistentLength?i.padStart(n.shortIdLength,n.paddingChar):i},d=(t,e)=>{const n=e(t).padStart(32,"0").match(/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/);return[n[1],n[2],n[3],n[4],n[5]].join("-")};t.exports=(()=>{const t=(t,e)=>{const n=t||s.flickrBase58,c={...a,...e};if([...new Set(Array.from(n))].length!==n.length)throw new Error("The provided Alphabet has duplicate characters resulting in unreliable results");const l=(f=n.length,Math.ceil(Math.log(2**128)/Math.log(f)));var f;const h={shortIdLength:l,consistentLength:c.consistentLength,paddingChar:n[0]},v=r(r.HEX,n),p=r(n,r.HEX),m=()=>u(i(),v,h),_={alphabet:n,fromUUID:t=>u(t,v,h),maxLength:l,generate:m,new:m,toUUID:t=>d(t,p),uuid:i,validate:(t,e=!1)=>{if(!t||"string"!=typeof t)return!1;const i=c.consistentLength?t.length===l:t.length<=l,r=t.split("").every((t=>n.includes(t)));return!1===e?i&&r:i&&r&&o(d(t,p))}};return Object.freeze(_),_};return t.constants=s,t.uuid=i,t.generate=()=>(c||(c=t(s.flickrBase58).generate),c()),t})()},831:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return c.default}});var i=f(n(518)),o=f(n(948)),r=f(n(73)),s=f(n(186)),a=f(n(808)),c=f(n(775)),u=f(n(37)),d=f(n(910)),l=f(n(792));function f(t){return t&&t.__esModule?t:{default:t}}},311:(t,e)=>{"use strict";function n(t){return 14+(t+64>>>9<<4)+1}function i(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t,e,n,o,r,s){return i((a=i(i(e,t),i(o,s)))<<(c=r)|a>>>32-c,n);var a,c}function r(t,e,n,i,r,s,a){return o(e&n|~e&i,t,e,r,s,a)}function s(t,e,n,i,r,s,a){return o(e&i|n&~i,t,e,r,s,a)}function a(t,e,n,i,r,s,a){return o(e^n^i,t,e,r,s,a)}function c(t,e,n,i,r,s,a){return o(n^(e|~i),t,e,r,s,a)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){const e=[],n=32*t.length,i="0123456789abcdef";for(let o=0;o<n;o+=8){const n=t[o>>5]>>>o%32&255,r=parseInt(i.charAt(n>>>4&15)+i.charAt(15&n),16);e.push(r)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[n(e)-1]=e;let o=1732584193,u=-271733879,d=-1732584194,l=271733878;for(let e=0;e<t.length;e+=16){const n=o,f=u,h=d,v=l;o=r(o,u,d,l,t[e],7,-680876936),l=r(l,o,u,d,t[e+1],12,-389564586),d=r(d,l,o,u,t[e+2],17,606105819),u=r(u,d,l,o,t[e+3],22,-1044525330),o=r(o,u,d,l,t[e+4],7,-176418897),l=r(l,o,u,d,t[e+5],12,1200080426),d=r(d,l,o,u,t[e+6],17,-1473231341),u=r(u,d,l,o,t[e+7],22,-45705983),o=r(o,u,d,l,t[e+8],7,1770035416),l=r(l,o,u,d,t[e+9],12,-1958414417),d=r(d,l,o,u,t[e+10],17,-42063),u=r(u,d,l,o,t[e+11],22,-1990404162),o=r(o,u,d,l,t[e+12],7,1804603682),l=r(l,o,u,d,t[e+13],12,-40341101),d=r(d,l,o,u,t[e+14],17,-1502002290),u=r(u,d,l,o,t[e+15],22,1236535329),o=s(o,u,d,l,t[e+1],5,-165796510),l=s(l,o,u,d,t[e+6],9,-1069501632),d=s(d,l,o,u,t[e+11],14,643717713),u=s(u,d,l,o,t[e],20,-373897302),o=s(o,u,d,l,t[e+5],5,-701558691),l=s(l,o,u,d,t[e+10],9,38016083),d=s(d,l,o,u,t[e+15],14,-660478335),u=s(u,d,l,o,t[e+4],20,-405537848),o=s(o,u,d,l,t[e+9],5,568446438),l=s(l,o,u,d,t[e+14],9,-1019803690),d=s(d,l,o,u,t[e+3],14,-187363961),u=s(u,d,l,o,t[e+8],20,1163531501),o=s(o,u,d,l,t[e+13],5,-1444681467),l=s(l,o,u,d,t[e+2],9,-51403784),d=s(d,l,o,u,t[e+7],14,1735328473),u=s(u,d,l,o,t[e+12],20,-1926607734),o=a(o,u,d,l,t[e+5],4,-378558),l=a(l,o,u,d,t[e+8],11,-2022574463),d=a(d,l,o,u,t[e+11],16,1839030562),u=a(u,d,l,o,t[e+14],23,-35309556),o=a(o,u,d,l,t[e+1],4,-1530992060),l=a(l,o,u,d,t[e+4],11,1272893353),d=a(d,l,o,u,t[e+7],16,-155497632),u=a(u,d,l,o,t[e+10],23,-1094730640),o=a(o,u,d,l,t[e+13],4,681279174),l=a(l,o,u,d,t[e],11,-358537222),d=a(d,l,o,u,t[e+3],16,-722521979),u=a(u,d,l,o,t[e+6],23,76029189),o=a(o,u,d,l,t[e+9],4,-640364487),l=a(l,o,u,d,t[e+12],11,-421815835),d=a(d,l,o,u,t[e+15],16,530742520),u=a(u,d,l,o,t[e+2],23,-995338651),o=c(o,u,d,l,t[e],6,-198630844),l=c(l,o,u,d,t[e+7],10,1126891415),d=c(d,l,o,u,t[e+14],15,-1416354905),u=c(u,d,l,o,t[e+5],21,-57434055),o=c(o,u,d,l,t[e+12],6,1700485571),l=c(l,o,u,d,t[e+3],10,-1894986606),d=c(d,l,o,u,t[e+10],15,-1051523),u=c(u,d,l,o,t[e+1],21,-2054922799),o=c(o,u,d,l,t[e+8],6,1873313359),l=c(l,o,u,d,t[e+15],10,-30611744),d=c(d,l,o,u,t[e+6],15,-1560198380),u=c(u,d,l,o,t[e+13],21,1309151649),o=c(o,u,d,l,t[e+4],6,-145523070),l=c(l,o,u,d,t[e+11],10,-1120210379),d=c(d,l,o,u,t[e+2],15,718787259),u=c(u,d,l,o,t[e+9],21,-343485551),o=i(o,n),u=i(u,f),d=i(d,h),l=i(l,v)}return[o,u,d,l]}(function(t){if(0===t.length)return[];const e=8*t.length,i=new Uint32Array(n(e));for(let n=0;n<e;n+=8)i[n>>5]|=(255&t[n/8])<<n%32;return i}(t),8*t.length))}},140:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};e.default=n},808:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default="00000000-0000-0000-0000-000000000000"},792:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o=(i=n(37))&&i.__esModule?i:{default:i};e.default=function(t){if(!(0,o.default)(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}},656:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},858:(t,e)=>{"use strict";let n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)};const i=new Uint8Array(16)},42:(t,e)=>{"use strict";function n(t,e,n,i){switch(t){case 0:return e&n^~e&i;case 1:case 3:return e^n^i;case 2:return e&n^e&i^n&i}}function i(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t){const e=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const r=t.length/4+2,s=Math.ceil(r/16),a=new Array(s);for(let e=0;e<s;++e){const n=new Uint32Array(16);for(let i=0;i<16;++i)n[i]=t[64*e+4*i]<<24|t[64*e+4*i+1]<<16|t[64*e+4*i+2]<<8|t[64*e+4*i+3];a[e]=n}a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<s;++t){const r=new Uint32Array(80);for(let e=0;e<16;++e)r[e]=a[t][e];for(let t=16;t<80;++t)r[t]=i(r[t-3]^r[t-8]^r[t-14]^r[t-16],1);let s=o[0],c=o[1],u=o[2],d=o[3],l=o[4];for(let t=0;t<80;++t){const o=Math.floor(t/20),a=i(s,5)+n(o,c,u,d)+l+e[o]+r[t]>>>0;l=d,d=u,u=i(c,30)>>>0,c=s,s=a}o[0]=o[0]+s>>>0,o[1]=o[1]+c>>>0,o[2]=o[2]+u>>>0,o[3]=o[3]+d>>>0,o[4]=o[4]+l>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}},910:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.unsafeStringify=s;var i,o=(i=n(37))&&i.__esModule?i:{default:i};const r=[];for(let t=0;t<256;++t)r.push((t+256).toString(16).slice(1));function s(t,e=0){return r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]}e.default=function(t,e=0){const n=s(t,e);if(!(0,o.default)(n))throw TypeError("Stringified UUID is invalid");return n}},518:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o=(i=n(858))&&i.__esModule?i:{default:i},r=n(910);let s,a,c=0,u=0;e.default=function(t,e,n){let i=e&&n||0;const d=e||new Array(16);let l=(t=t||{}).node||s,f=void 0!==t.clockseq?t.clockseq:a;if(null==l||null==f){const e=t.random||(t.rng||o.default)();null==l&&(l=s=[1|e[0],e[1],e[2],e[3],e[4],e[5]]),null==f&&(f=a=16383&(e[6]<<8|e[7]))}let h=void 0!==t.msecs?t.msecs:Date.now(),v=void 0!==t.nsecs?t.nsecs:u+1;const p=h-c+(v-u)/1e4;if(p<0&&void 0===t.clockseq&&(f=f+1&16383),(p<0||h>c)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=h,u=v,a=f,h+=122192928e5;const m=(1e4*(268435455&h)+v)%4294967296;d[i++]=m>>>24&255,d[i++]=m>>>16&255,d[i++]=m>>>8&255,d[i++]=255&m;const _=h/4294967296*1e4&268435455;d[i++]=_>>>8&255,d[i++]=255&_,d[i++]=_>>>24&15|16,d[i++]=_>>>16&255,d[i++]=f>>>8|128,d[i++]=255&f;for(let t=0;t<6;++t)d[i+t]=l[t];return e||(0,r.unsafeStringify)(d)}},948:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(25)),o=r(n(311));function r(t){return t&&t.__esModule?t:{default:t}}var s=(0,i.default)("v3",48,o.default);e.default=s},25:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(t,e,n){function i(t,i,s,a){var c;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof i&&(i=(0,r.default)(i)),16!==(null===(c=i)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+t.length);if(u.set(i),u.set(t,i.length),u=n(u),u[6]=15&u[6]|e,u[8]=63&u[8]|128,s){a=a||0;for(let t=0;t<16;++t)s[a+t]=u[t];return s}return(0,o.unsafeStringify)(u)}try{i.name=t}catch(t){}return i.DNS=s,i.URL=a,i};var i,o=n(910),r=(i=n(792))&&i.__esModule?i:{default:i};const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=a},73:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n(140)),o=s(n(858)),r=n(910);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,n){if(i.default.randomUUID&&!e&&!t)return i.default.randomUUID();const s=(t=t||{}).random||(t.rng||o.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=s[t];return e}return(0,r.unsafeStringify)(s)}},186:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(25)),o=r(n(42));function r(t){return t&&t.__esModule?t:{default:t}}var s=(0,i.default)("v5",80,o.default);e.default=s},37:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o=(i=n(656))&&i.__esModule?i:{default:i};e.default=function(t){return"string"==typeof t&&o.default.test(t)}},775:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o=(i=n(37))&&i.__esModule?i:{default:i};e.default=function(t){if(!(0,o.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";class t{}t.MAX_BUFFER_SIZE=1e3,t.EVENT_BUFFER_TIMEOUT=2e3,t.MAX_RECONNECT_ATTEMPTS=10,t.MAX_RECONNECT_INTERVAL=3e4,t.RECONNECT_INTERVAL=1e3;const e=t;const i=()=>{let t=[],n=[];return[n=>{t.length>=e.MAX_BUFFER_SIZE&&t.shift(),t.push(n)},(e,i)=>{return o=void 0,r=void 0,a=function*(){e&&e.readyState&&t.length>0&&([t,n]=[n,t],yield e.send(JSON.stringify({subject:i,data:{records:n}})),n=[])},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{c(a.next(t))}catch(t){e(t)}}function i(t){try{c(a.throw(t))}catch(t){e(t)}}function c(e){var o;e.done?t(e.value):(o=e.value,o instanceof s?o:new s((function(t){t(o)}))).then(n,i)}c((a=a.apply(o,r||[])).next())}));var o,r,s,a}]};var o,r;(r=o||(o={})).MouseClick="mouseclick",r.MouseMove="mousemove",r.Navigation="navigation",r.Resize="resize",r.Scroll="scroll",r.VisibilityChange="visibilitychange",r.Connection="connection",r.Reconnection="reconnection";const s=class{constructor(){[this.addEvent,this._pushEvents]=i(),this.pushEvents=t=>{return e=this,n=void 0,o=function*(){yield this._pushEvents(t,this.subject)},new((i=void 0)||(i=Promise))((function(t,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}c((o=o.apply(e,n||[])).next())}));var e,n,i,o}}};class a extends s{constructor(){super(),this.subject=o.MouseClick}static instance(){return this._instance||(this._instance=new a),this._instance}}a.instance();const c=a;class u{constructor(){[this.addEvent,this._pushEvents]=i(),this.pushEvents=t=>{return e=this,n=void 0,r=function*(){yield this._pushEvents(t,o.MouseMove)},new((i=void 0)||(i=Promise))((function(t,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}c((r=r.apply(e,n||[])).next())}));var e,n,i,r}}static instance(){return this._instance||(this._instance=new u),this._instance}}u.instance();const d=u;class l extends s{constructor(){super(),this.subject=o.Navigation}static instance(){return this._instance||(this._instance=new l),this._instance}}l.instance();const f=l;class h{constructor(){[this.addEvent,this._pushEvents]=i(),this.pushEvents=t=>{return e=this,n=void 0,r=function*(){yield this._pushEvents(t,o.Resize)},new((i=void 0)||(i=Promise))((function(t,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}c((r=r.apply(e,n||[])).next())}));var e,n,i,r}}static instance(){return this._instance||(this._instance=new h),this._instance}}h.instance();const v=h;class p{constructor(){[this.addEvent,this._pushEvents]=i(),this.pushEvents=t=>{return e=this,n=void 0,r=function*(){yield this._pushEvents(t,o.Scroll)},new((i=void 0)||(i=Promise))((function(t,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}c((r=r.apply(e,n||[])).next())}));var e,n,i,r}}static instance(){return this._instance||(this._instance=new p),this._instance}}p.instance();const m=p;class _{constructor(){[this.addEvent,this._pushEvents]=i(),this.pushEvents=t=>{return e=this,n=void 0,r=function*(){yield this._pushEvents(t,o.VisibilityChange)},new((i=void 0)||(i=Promise))((function(t,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,a)}c((r=r.apply(e,n||[])).next())}));var e,n,i,r}}static instance(){return this._instance||(this._instance=new _),this._instance}}_.instance();const y=_;const w=()=>{return t=void 0,e=void 0,i=function*(){return new Promise(((t,e)=>{fetch("https://api.ipify.org?format=json").then((t=>t.json())).then((e=>t(e.ip))).catch((t=>e(t)))}))},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i};var b=n(943),g=n.n(b);class E{constructor(t,e){this.id=t,this.ip=e,this.browser=function(){const t=navigator.userAgent;return t.indexOf("Edg")>-1?"edge":t.indexOf("Chrome")>-1?"chrome":t.indexOf("Firefox")>-1?"firefox":t.indexOf("Safari")>-1?"safari":t.indexOf("Opera")>-1?"opera":t.indexOf("Trident")>-1||t.indexOf("MSIE")>-1?"ie":"unknown"}(),[this.domain]=function(){var t;const e=null===(t=document.querySelector('meta[name="analytiq-domain"]'))||void 0===t?void 0:t.getAttribute("content");if(!e)throw new Error("Domain name not set in metadata");return[e]}(),this.subdomain=window.location.hostname,this.page=window.location.hostname+window.location.pathname,this.firstLoad=!0,this.reconnectAttempts=0}static initialize(){return t=this,e=void 0,i=function*(){const t=g().uuid(),e=yield w();this._instance=new E(t,e)},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i}static instance(){if(!this._instance)throw new Error("GlobalState must be initialized before accessing it's instance");return this._instance}}E._instance=null;const M=E;function O(){const t=M.instance();setTimeout((()=>{const e=window.location.hostname+window.location.pathname;t.page!=e&&(t.page=e,f.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,page:t.page,html:document.documentElement.outerHTML,timeStamp:performance.now()})),O()}),1e3)}const x=()=>{const t=M.instance();window.addEventListener("mousemove",(e=>{d.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,x:e.x,y:e.y,timeStamp:e.timeStamp})})),window.addEventListener("resize",(e=>{const n=e.target;v.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,width:n.innerWidth,height:n.innerHeight,timeStamp:e.timeStamp})})),window.addEventListener("visibilitychange",(e=>{y.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,visibility:document.visibilityState,timeStamp:e.timeStamp})})),window.addEventListener("scroll",(e=>{m.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,x:window.scrollX,y:window.scrollY,timeStamp:e.timeStamp})})),window.addEventListener("click",(e=>{c.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,x:e.x,y:e.y,timeStamp:e.timeStamp})})),["firefox","safari","unknown"].includes(t.browser)?O():window.navigation.addEventListener("navigate",(e=>{t.page=window.location.hostname+new URL(e.destination.url).pathname,f.instance().addEvent({domain:t.domain,subdomain:t.subdomain,id:t.id,ip:t.ip,page:t.page,html:document.documentElement.outerHTML,timeStamp:performance.now()})}))};var A=function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};class T{constructor(){this._socket=null}static initialize(){this._instance||(this._instance=new T)}static socket(t){if(!this._instance)throw new Error(`Socket need to be initialized before ${t}`);if(!this._instance._socket)throw new Error(`Socket need to be connected before ${t}`);return this._instance._socket}static _handleEventBufferTimeout(){return A(this,void 0,void 0,(function*(){M.instance().eventBufferTimeout=window.setTimeout((()=>A(this,void 0,void 0,(function*(){const t=[c.instance().pushEvents(this.socket("_handleEventBufferTimeout")),d.instance().pushEvents(this.socket("_handleEventBufferTimeout")),f.instance().pushEvents(this.socket("_handleEventBufferTimeout")),v.instance().pushEvents(this.socket("_handleEventBufferTimeout")),m.instance().pushEvents(this.socket("_handleEventBufferTimeout")),y.instance().pushEvents(this.socket("_handleEventBufferTimeout"))];yield Promise.all(t),T._handleEventBufferTimeout()}))),e.EVENT_BUFFER_TIMEOUT)}))}static _handleOpen(){return A(this,void 0,void 0,(function*(){const t=M.instance();t.reconnectAttempts=0;const e={subject:t.firstLoad?o.Connection:o.Reconnection,data:{ip:t.ip,id:t.id,html:document.documentElement.outerHTML,domain:t.domain,subdomain:t.subdomain,page:t.page,timeStamp:performance.now()}};this.socket("_handleOpen").send(JSON.stringify(e)),t.firstLoad=!1,this._handleEventBufferTimeout()}))}static _handleClose(){const t=M.instance();t.eventBufferTimeout&&clearTimeout(t.eventBufferTimeout),this.reconnect()}static _handleError(){this.socket("_handleError").close()}static connect(){return A(this,void 0,void 0,(function*(){if(!this._instance)throw new Error("Socket need to be initialized before connect()");this._instance._socket=new WebSocket("ws://analytiq.in/api/v1/visitorwss"),this._instance._socket.addEventListener("open",(()=>this._handleOpen())),this._instance._socket.addEventListener("close",(()=>this._handleClose())),this._instance._socket.addEventListener("error",(()=>this._handleError()))}))}static reconnect(){return A(this,void 0,void 0,(function*(){const t=M.instance();t.reconnectAttempts<e.MAX_RECONNECT_ATTEMPTS?setTimeout((()=>A(this,void 0,void 0,(function*(){t.reconnectAttempts++,yield this.connect()}))),Math.min(e.RECONNECT_INTERVAL*Math.pow(2,t.reconnectAttempts),e.MAX_RECONNECT_INTERVAL)):console.log("Max connection attemps have be reached.")}))}}T._instance=null,T.initialize();const S=T;var P,U;U=function*(){yield M.initialize(),x(),S.connect()},new((P=void 0)||(P=Promise))((function(t,e){function n(t){try{o(U.next(t))}catch(t){e(t)}}function i(t){try{o(U.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof P?o:new P((function(t){t(o)}))).then(n,i)}o((U=U.apply(void 0,[])).next())}))})()})();